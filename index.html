<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FeelMeter (ফিলমিটার)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
      body {
        font-family: 'Hind Siliguri', 'Poppins', sans-serif;
      }
      .font-poppins {
        font-family: 'Poppins', sans-serif;
      }
    </style>

    <!-- Import Map for JavaScript Libraries -->
    <script type="importmap">
    {
      "imports": {
        "framer-motion": "https://esm.sh/framer-motion@11.2.1?deps=react@18.2.0",
        "react-router-dom": "https://esm.sh/react-router-dom@6.23.1?deps=react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "react-dom/": "https://esm.sh/react-dom@18.2.0/",
        "recharts": "https://esm.sh/recharts@2.12.7?deps=react@18.2.0,react-dom@18.2.0",
        "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime",
        "react/": "https://esm.sh/react@18.2.0/",
        "react": "https://esm.sh/react@18.2.0",
        "react-icons/fa6": "https://esm.sh/react-icons@5.2.1/fa6?deps=react@18.2.0",
        "react-confetti": "https://esm.sh/react-confetti@6.1.0?deps=react@18.2.0,react-dom@18.2.0"
      }
    }
    </script>
    
    <!-- Babel for in-browser JSX/TSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-white text-gray-800">
    <div id="root"></div>

    <!-- All React Application Code -->
    <script type="text/babel" data-presets="react,typescript" data-type="module">
      import React, { useState, useEffect, useRef, StrictMode } from 'react';
      import ReactDOM from 'react-dom/client';
      import { HashRouter, Routes, Route, NavLink, Link, useLocation } from 'react-router-dom';
      import { motion, AnimatePresence, useScroll, useTransform } from 'framer-motion';
      import { BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } from 'recharts';
      import Confetti from 'react-confetti';
      import {
        FaFacebook, FaTwitter, FaInstagram, FaHeart, FaUserGroup, FaBed,
        FaFaceSmile, FaShareNodes, FaArrowRotateRight, FaPlus, FaTrash,
        FaPencil, FaArrowRightFromBracket
      } from 'react-icons/fa6';

      // ============= TYPES =============
      // These are TypeScript interfaces and enums for type safety.
      // Babel will strip them out during transpilation.
      
      interface PollOption {
        text: string;
        votes: number;
      }

      interface Poll {
        id: string;
        title: string;
        description?: string;
        options: PollOption[];
        category: string;
        createdAt: number;
        duration: number; 
      }

      interface MeterQuestion {
        question: string;
        options: string[];
        type: 'radio' | 'slider';
      }

      enum MeterCategory {
        Love = "ভালোবাসা",
        Friendship = "বন্ধুত্ব",
        Laziness = "অলসতা",
        Mood = "মুড",
        Maturity = "ম্যাচিউরিটি",
        Frustration = "হতাশার লেবেল",
        Foodie = "খাদ্য প্রেমিক",
        Intelligence = "বুদ্ধিমত্তা মিটার",
        Creativity = "সৃজনশীলতা স্কোর"
      }

      // ============= HOOKS =============

      function useLocalStorage<T>(key: string, initialValue: T) {
        const [storedValue, setStoredValue] = useState<T>(() => {
          try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
          } catch (error) {
            console.log(error);
            return initialValue;
          }
        });

        const setValue = (value: T | ((val: T) => T)) => {
          try {
            const valueToStore = value instanceof Function ? value(storedValue) : value;
            setStoredValue(valueToStore);
            window.localStorage.setItem(key, JSON.stringify(valueToStore));
          } catch (error) {
            console.log(error);
          }
        };
        
        useEffect(() => {
          const handleStorageChange = (e: StorageEvent) => {
            if (e.key === key) {
              try {
                setStoredValue(e.newValue ? JSON.parse(e.newValue) : initialValue);
              } catch (error) {
                console.log(error);
              }
            }
          };
          window.addEventListener('storage', handleStorageChange);
          return () => {
            window.removeEventListener('storage', handleStorageChange);
          };
        }, [key, initialValue]);

        return [storedValue, setValue] as const;
      }

      // ============= COMPONENTS =============

      const Header: React.FC = () => {
        const activeLinkClass = "text-transparent bg-clip-text bg-gradient-to-r from-[#FF6B81] to-[#6C63FF] font-bold";
        const inactiveLinkClass = "hover:text-[#FF6B81] transition-colors duration-300";

        return (
          <header className="sticky top-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
            <div className="container mx-auto px-6 py-4 flex justify-between items-center">
              <NavLink to="/" className="text-3xl font-bold text-gray-800 font-poppins">
                Feel<span className="text-[#FF6B81]">Meter</span> <span className="text-xl">ফিলমিটার</span>
              </NavLink>
              <nav className="hidden md:flex items-center space-x-8 text-lg font-semibold">
                <NavLink to="/" className={({ isActive }) => (isActive ? activeLinkClass : inactiveLinkClass)}>হোম</NavLink>
                <NavLink to="/calculate" className={({ isActive }) => (isActive ? activeLinkClass : inactiveLinkClass)}>পরিমাপ করুন</NavLink>
                <NavLink to="/poll" className={({ isActive }) => (isActive ? activeLinkClass : inactiveLinkClass)}>ভোট দিন</NavLink>
              </nav>
            </div>
          </header>
        );
      };

      const Footer: React.FC = () => {
        return (
          <footer className="bg-white/50 border-t border-gray-200 mt-16">
            <div className="container mx-auto px-6 py-8 text-center text-gray-600">
              <p className="mb-4">© {new Date().getFullYear()} ফিলমিটার। সর্বস্বত্ব সংরক্ষিত।</p>
              <div className="flex justify-center space-x-6">
                <a href="#" className="hover:text-[#FF6B81] transition-colors"><FaFacebook size={24} /></a>
                <a href="#" className="hover:text-[#FF6B81] transition-colors"><FaTwitter size={24} /></a>
                <a href="#" className="hover:text-[#FF6B81] transition-colors"><FaInstagram size={24} /></a>
              </div>
              <div className="mt-6 pt-6 border-t border-gray-200/50">
                <Link to="/admin" className="text-sm text-gray-500 hover:text-gray-800 hover:underline transition-colors">
                  অ্যাডমিন লগইন
                </Link>
              </div>
            </div>
          </footer>
        );
      };

      // ============= PAGES =============

      const HomePage: React.FC = () => {
        const [polls] = useLocalStorage<Poll[]>('polls', []);

        const heroRef = useRef<HTMLDivElement>(null);
        const { scrollYProgress } = useScroll({
          target: heroRef,
          offset: ["start start", "end start"]
        });
        const backgroundY = useTransform(scrollYProgress, [0, 1], ["0%", "50%"]);

        const featuredCategories = [
          { name: "ভালোবাসার মিটার", icon: <FaHeart className="text-5xl text-red-400" />, link: "/calculate?category=ভালোবাসা" },
          { name: "বন্ধুত্বের স্কেল", icon: <FaUserGroup className="text-5xl text-blue-400" />, link: "/calculate?category=বন্ধুত্ব" },
          { name: "মুড মিটার", icon: <FaFaceSmile className="text-5xl text-yellow-400" />, link: "/calculate?category=মুড" },
          { name: "অলসতা স্কোর", icon: <FaBed className="text-5xl text-purple-400" />, link: "/calculate?category=অলসতা" },
        ];
        
        const heroContainerVariants = {
          hidden: { opacity: 0 },
          visible: {
            opacity: 1,
            transition: { staggerChildren: 0.2, delayChildren: 0.3 },
          },
        };

        const heroItemVariants = {
          hidden: { y: 20, opacity: 0 },
          visible: {
            y: 0,
            opacity: 1,
            transition: { duration: 0.6, ease: "easeOut" }
          },
        };

        const categoryContainerVariants = {
          hidden: { opacity: 0 },
          visible: {
            opacity: 1,
            transition: { staggerChildren: 0.15 },
          },
        };

        const categoryCardVariants = {
          hidden: { opacity: 0, y: 50, filter: 'blur(10px)' },
          visible: { 
            opacity: 1, 
            y: 0, 
            filter: 'blur(0px)',
            transition: { duration: 0.6, ease: "easeOut" }
          },
        };

        return (
          <div className="space-y-20 md:space-y-32">
            {/* Hero Section */}
            <section ref={heroRef} className="relative text-center py-20 md:py-32 px-4 overflow-hidden">
              <motion.div 
                style={{ y: backgroundY }}
                className="absolute inset-0 bg-gradient-to-r from-[#FF6B81]/20 via-[#FFB6C1]/20 to-[#6C63FF]/20 animate-[pulse_8s_ease-in-out_infinite] blur-3xl"
              ></motion.div>
              <motion.div 
                variants={heroContainerVariants}
                initial="hidden"
                animate="visible"
                className="relative z-10"
              >
                <motion.h1 variants={heroItemVariants} className="text-4xl md:text-6xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-800 to-gray-600">
                  ফিলমিটার, যেখানে অনুভূতি মাপা যায়!
                </motion.h1>
                <motion.p variants={heroItemVariants} className="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                  ভালোবাসা, বন্ধুত্ব, মুড কিংবা অলসতা - সবকিছুরই পরিমাপ আছে এখানে! যা মাপে না মন, তা মাপে ফিলমিটার!
                </motion.p>
                <motion.div variants={heroItemVariants}>
                  <Link to="/calculate">
                    <motion.button 
                      whileHover={{ scale: 1.05, boxShadow: "0px 0px 20px rgba(255, 107, 129, 0.7)" }}
                      whileTap={{ scale: 0.95 }}
                      className="px-8 py-4 bg-gradient-to-r from-[#FF6B81] to-[#FFB6C1] text-white font-bold text-lg rounded-full shadow-lg transition-all duration-300"
                    >
                      শুরু করুন
                    </motion.button>
                  </Link>
                </motion.div>
              </motion.div>
            </section>

            {/* Featured Categories */}
            <section className="container mx-auto px-6">
              <h2 className="text-3xl md:text-4xl font-bold text-center mb-12">কী মাপতে চান?</h2>
              <motion.div 
                variants={categoryContainerVariants}
                initial="hidden"
                whileInView="visible"
                viewport={{ once: true, amount: 0.2 }}
                className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                {featuredCategories.map((cat) => (
                  <motion.div
                    key={cat.name}
                    variants={categoryCardVariants}
                    whileHover={{ y: -8, boxShadow: "0px 10px 25px rgba(108, 99, 255, 0.15)" }}
                    transition={{ duration: 0.3 }}
                  >
                    <Link to={cat.link} className="block p-8 bg-white rounded-2xl shadow-lg h-full text-center group">
                      <div className="flex justify-center mb-4 transition-transform duration-300 group-hover:scale-110">
                        {cat.icon}
                      </div>
                      <h3 className="text-xl font-semibold text-gray-800">{cat.name}</h3>
                    </Link>
                  </motion.div>
                ))}
              </motion.div>
            </section>
            
            {/* Poll Preview */}
            {polls.length > 0 && (
              <section className="container mx-auto px-6">
                <h2 className="text-3xl md:text-4xl font-bold text-center mb-12">🗳️ আজকের ভোট</h2>
                <div className="max-w-3xl mx-auto space-y-6">
                  {polls.slice(0, 3).map(poll => (
                    <motion.div
                      key={poll.id}
                      initial={{ opacity: 0, x: -50 }}
                      whileInView={{ opacity: 1, x: 0 }}
                      viewport={{ once: true }}
                      transition={{ duration: 0.5 }}
                      className="bg-white p-6 rounded-xl shadow-md flex justify-between items-center"
                    >
                      <div>
                        <h3 className="text-xl font-semibold text-gray-800">{poll.title}</h3>
                        <p className="text-gray-500">{poll.category}</p>
                      </div>
                      <Link to="/poll">
                        <motion.button
                          whileHover={{ scale: 1.05, boxShadow: "0px 0px 15px rgba(108, 99, 255, 0.6)" }}
                          className="px-6 py-2 bg-[#6C63FF] text-white font-semibold rounded-full shadow-md hover:bg-opacity-90 transition-all"
                        >
                          ভোট দিন
                        </motion.button>
                      </Link>
                    </motion.div>
                  ))}
                </div>
              </section>
            )}
          </div>
        );
      };
      
      const CalculatePage: React.FC = () => {
        const location = useLocation();
        const queryParams = new URLSearchParams(location.search);
        const initialCategory = (queryParams.get('category') as MeterCategory) || '';
        
        const [selectedCategory, setSelectedCategory] = useState<MeterCategory | ''>(initialCategory);
        const [names, setNames] = useState({ name1: '', name2: '' });
        const [answers, setAnswers] = useState<number[]>([]);
        const [result, setResult] = useState<number | null>(null);

        const questionsData: Record<MeterCategory, MeterQuestion[]> = {
          [MeterCategory.Love]: [
            { question: "আপনারা একসাথে কতটা সময় কাটান?", options: ["খুব কম", "মাঝে মাঝে", "অনেক"], type: 'radio' },
            { question: "ছোট ছোট বিষয়ে কি আপনারা ঝগড়া করেন?", options: ["হ্যাঁ, প্রায়ই", "মাঝে মাঝে", "না, করি না"], type: 'radio' },
            { question: "একে অপরকে কতটা বোঝেন?", options: ["একদমই না", "মোটামুটি", "খুব ভালো"], type: 'radio' },
          ],
          [MeterCategory.Friendship]: [
            { question: "বিপদে পড়লে কাকে আগে ফোন দেন?", options: ["পরিবারকে", "এই বন্ধুকে", "অন্য কাউকে"], type: 'radio' },
            { question: "আপনাদের মধ্যে গোপন কথা শেয়ার হয়?", options: ["না, হয় না", "কিছু কিছু", "সবকিছু"], type: 'radio' },
            { question: "কতদিন কথা না বলে থাকতে পারেন?", options: ["এক সপ্তাহ", "এক মাস", "এক বছর"], type: 'radio' },
          ],
          [MeterCategory.Laziness]: [
            { question: "সকালে ঘুম থেকে উঠতে কেমন লাগে?", options: ["খুব কষ্ট", "মাঝে মাঝে", "সহজ"], type: 'radio' },
            { question: "আজকের কাজ কি কালকের জন্য রাখেন?", options: ["সবসময়", "মাঝে মাঝে", "কখনোই না"], type: 'radio' },
            { question: "বিছানা থেকে উঠতে কতক্ষণ লাগে?", options: ["৩০ মিনিটের বেশি", "১০-২০ মিনিট", "৫ মিনিটের কম"], type: 'radio' },
          ],
          [MeterCategory.Mood]: [
            { question: "আজ আপনার দিনটা কেমন যাচ্ছে?", options: ["খুব খারাপ", "মোটামুটি", "চমৎকার"], type: 'radio' },
            { question: "ছোট বিষয়ে কি মেজাজ খারাপ হয়?", options: ["হ্যাঁ, প্রায়ই", "মাঝে মাঝে", "না"], type: 'radio' },
            { question: "আপনার কি এখন গান শুনতে ইচ্ছা করছে?", options: ["হ্যাঁ", "না", "কিছু বলতে পারছি না"], type: 'radio' },
          ],
          [MeterCategory.Maturity]: [
            { question: "সমালোচনা কীভাবে গ্রহণ করেন?", options: ["খুব রেগে যাই", "কিছুটা খারাপ লাগে", "ভুল থেকে শিখি"], type: 'radio' },
            { question: "আবেগ দিয়ে সিদ্ধান্ত নেন নাকি যুক্তি দিয়ে?", options: ["শুধু আবেগ", "দুটোই", "শুধু যুক্তি"], type: 'radio' },
            { question: "ভবিষ্যৎ নিয়ে কি আপনি চিন্তিত?", options: ["অতিরিক্ত", "মাঝে মাঝে", "পরিকল্পনা করে চলি"], type: 'radio' },
          ],
          [MeterCategory.Frustration]: [
            { question: "ছোটখাটো বিষয়ে কি হতাশ হন?", options: ["হ্যাঁ, সবসময়", "মাঝে মাঝে", "না, হই না"], type: 'radio' },
            { question: "মনে হয় কি আপনার সাথে কিছুই ভালো হয় না?", options: ["হ্যাঁ, প্রায়ই", "কখনো কখনো", "না, মনে হয় না"], type: 'radio' },
            { question: "কতটা একা লাগে আপনার?", options: ["খুব বেশি", "মাঝে মাঝে", "লাগে না"], type: 'radio' },
          ],
          [MeterCategory.Foodie]: [
            { question: "নতুন খাবার চেষ্টা করতে কেমন লাগে?", options: ["ভয় লাগে", "মাঝে মাঝে", "খুব ভালোবাসি"], type: 'radio' },
            { question: "আপনার কি প্রায়ই ক্ষুধা লাগে?", options: ["হ্যাঁ, সবসময়", "মাঝে মাঝে", "না"], type: 'radio' },
            { question: "맛집 দেখলেই কি খেতে ইচ্ছা করে?", options: ["হ্যাঁ!", "না", "কখনো কখনো"], type: 'radio' },
          ],
          [MeterCategory.Intelligence]: [
            { question: "একটি কঠিন সমস্যা সমাধানে আপনার কেমন লাগে?", options: ["বিরক্ত লাগে", "চ্যালেঞ্জিং", "খুব মজা পাই"], type: 'radio' },
            { question: "নতুন কিছু শিখতে আপনার আগ্রহ কেমন?", options: ["খুব কম", "মাঝে মাঝে", "অনেক বেশি"], type: 'radio' },
            { question: "আপনি কি প্রায়ই প্রশ্ন করেন 'কেন' বা 'কীভাবে'?", options: ["না", "মাঝে মাঝে", "হ্যাঁ, সবসময়"], type: 'radio' },
          ],
          [MeterCategory.Creativity]: [
            { question: "একটি খালি কাগজ দেখলে আপনার কী করতে ইচ্ছে করে?", options: ["কিছুই না", "কিছু লিখতে", "ছবি আঁকতে"], type: 'radio' },
            { question: "আপনি কি গতানুগতিক ধারার বাইরে ভাবতে পছন্দ করেন?", options: ["না", "মাঝে মাঝে", "হ্যাঁ, সবসময়"], type: 'radio' },
            { question: "আপনার কি দিনের বেলায় স্বপ্ন দেখার অভ্যাস আছে?", options: ["না", "মাঝে মাঝে", "হ্যাঁ, প্রায়ই"], type: 'radio' },
          ]
        };

        const resultTexts: Record<MeterCategory, (score: number) => string> = {
            [MeterCategory.Love]: score => `আপনার ভালোবাসার মাত্রা: ${score}%! 🥰 ${score > 80 ? 'এটা একেবারে প্রেমিক-লেভেল ভালোবাসা!' : (score > 50 ? 'আপনাদের সম্পর্ক বেশ মজবুত।' : 'আরও একটু যত্ন নিন সম্পর্কের।')}`,
            [MeterCategory.Friendship]: score => `আপনাদের বন্ধুত্বের স্কেল: ${score}%! 🤝 ${score > 85 ? 'আপনারা তো একেবারে হরিহর আত্মা!' : (score > 60 ? 'বন্ধুত্ব বেশ ভালো, চালিয়ে যান।': 'বন্ধুত্বের চর্চা দরকার।')}`,
            [MeterCategory.Laziness]: score => `আপনার অলসতা স্কোর: ${score}%! 💤 ${score > 80 ? 'আপনি তো কুম্ভকর্ণের বংশধর!' : (score > 50 ? 'মাঝে মাঝে আলসেমি করা ভালো।' : 'আপনি খুবই পরিশ্রমী!')}`,
            [MeterCategory.Mood]: score => `আপনার মুড মিটার: ${score}%! 🎨 ${score > 75 ? 'আপনার মন আজ ফুরফুরে!' : (score > 40 ? 'মন মোটামুটি ভালো।': 'মনটা একটু ভালো করুন।')}`,
            [MeterCategory.Maturity]: score => `আপনার ম্যাচিউরিটি লেভেল: ${score}%! 🤔 ${score > 80 ? 'আপনি বয়সের চেয়ে অনেক বেশি পরিণত!' : (score > 50 ? 'আপনি সঠিক পথেই আছেন।': 'অভিজ্ঞতা আপনাকে আরও শেখাবে।')}`,
            [MeterCategory.Frustration]: score => `আপনার হতাশার লেবেল: ${score}%! 😟 ${score > 70 ? 'মনে হচ্ছে আপনি খুব কঠিন সময় পার করছেন।' : (score > 40 ? 'কিছুটা চাপ আছে, তবে ঠিক হয়ে যাবে।': 'আপনি বেশ শান্ত আছেন।')}`,
            [MeterCategory.Foodie]: score => `আপনি ${score}% খাদ্য প্রেমিক! 🍔 ${score > 85 ? 'খাবারই আপনার প্রথম ভালোবাসা!' : (score > 60 ? 'আপনি খেতে ভালোবাসেন।': 'আপনি স্বাস্থ্যের প্রতি বেশ সচেতন।')}`,
            [MeterCategory.Intelligence]: score => `আপনার বুদ্ধিমত্তা মিটার: ${score}%! 🧠 ${score > 85 ? 'আপনি তো আইনস্টাইনের কাছাকাছি!' : (score > 60 ? 'আপনার মস্তিষ্ক বেশ ধারালো।': 'একটু ভাবলেই পারবেন।')}`,
            [MeterCategory.Creativity]: score => `আপনার সৃজনশীলতা স্কোর: ${score}%! ✨ ${score > 85 ? 'আপনার কল্পনাশক্তি অসাধারণ!' : (score > 60 ? 'আপনি বেশ সৃজনশীল।': 'আপনার মধ্যে একজন শিল্পী লুকিয়ে আছে।')}`,
        };

        useEffect(() => {
          setSelectedCategory(initialCategory);
          resetForm();
        }, [initialCategory]);

        const handleCategoryChange = (e: React.ChangeEvent<HTMLSelectElement>) => {
          setSelectedCategory(e.target.value as MeterCategory);
          resetForm();
        };
        
        const resetForm = () => {
          setNames({ name1: '', name2: '' });
          setAnswers([]);
          setResult(null);
        }

        const handleAnswer = (qIndex: number, value: number) => {
          const newAnswers = [...answers];
          newAnswers[qIndex] = value;
          setAnswers(newAnswers);
        };
        
        const calculateResult = () => {
          const totalPossibleScore = (questionsData[selectedCategory as MeterCategory]?.length || 0) * 2;
          const userScore = answers.reduce((acc, curr) => acc + curr, 0);
          const percentage = Math.floor(((userScore + Math.random() * 2) / (totalPossibleScore + 1)) * 100);
          setResult(Math.min(100, Math.max(10, percentage)));
        };

        const isFormComplete = selectedCategory && 
          (![MeterCategory.Love, MeterCategory.Friendship].includes(selectedCategory) || (names.name1 && names.name2)) &&
          (answers.length === questionsData[selectedCategory]?.length && answers.every(a => a !== undefined));

        return (
          <div className="container mx-auto px-6 py-12">
            <div className="max-w-2xl mx-auto bg-white p-8 rounded-2xl shadow-xl">
              <AnimatePresence mode="wait">
                {result === null ? (
                  <motion.div
                    key="form"
                    initial={{ opacity: 0, x: -50 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: 50 }}
                    transition={{ duration: 0.5 }}
                  >
                    <h1 className="text-3xl font-bold text-center mb-6">অনুভূতি পরিমাপ করুন</h1>
                    <div className="mb-6">
                      <label className="block text-lg font-semibold mb-2" htmlFor="category-select">আপনি কী মাপতে চান?</label>
                      <select 
                        id="category-select" 
                        value={selectedCategory} 
                        onChange={handleCategoryChange}
                        className="w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-[#FF6B81] focus:border-transparent transition"
                      >
                        <option value="" disabled>একটি নির্বাচন করুন</option>
                        {Object.values(MeterCategory).map(cat => <option key={cat} value={cat}>{cat}</option>)}
                      </select>
                    </div>

                    {selectedCategory && (
                      <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>
                        {[MeterCategory.Love, MeterCategory.Friendship].includes(selectedCategory) && (
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <input type="text" placeholder="আপনার নাম" value={names.name1} onChange={e => setNames({...names, name1: e.target.value})} className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#6C63FF]"/>
                            <input type="text" placeholder="অন্যজনের নাম" value={names.name2} onChange={e => setNames({...names, name2: e.target.value})} className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#6C63FF]"/>
                          </div>
                        )}

                        {questionsData[selectedCategory].map((q, qIndex) => (
                          <div key={qIndex} className="mb-6 p-4 bg-pink-50/50 rounded-lg">
                            <p className="font-semibold mb-3">{q.question}</p>
                            <div className="flex justify-around">
                              {q.options.map((opt, oIndex) => (
                                <label key={oIndex} className="flex items-center space-x-2 cursor-pointer">
                                  <input type="radio" name={`q${qIndex}`} checked={answers[qIndex] === oIndex} onChange={() => handleAnswer(qIndex, oIndex)} className="form-radio text-[#FF6B81] focus:ring-[#FF6B81]"/>
                                  <span>{opt}</span>
                                </label>
                              ))}
                            </div>
                          </div>
                        ))}

                        <motion.button 
                          onClick={calculateResult}
                          disabled={!isFormComplete}
                          whileHover={{ scale: isFormComplete ? 1.05 : 1 }}
                          className="w-full p-4 bg-gradient-to-r from-[#FF6B81] to-[#FFB6C1] text-white font-bold text-lg rounded-full shadow-lg transition disabled:bg-gray-400 disabled:cursor-not-allowed disabled:shadow-none"
                        >
                          ফলাফল দেখুন
                        </motion.button>
                      </motion.div>
                    )}
                  </motion.div>
                ) : (
                  <motion.div
                    key="result"
                    initial={{ opacity: 0, scale: 0.8 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.8 }}
                    transition={{ duration: 0.5 }}
                    className="text-center"
                  >
                    <h2 className="text-2xl font-bold mb-4">আপনার ফলাফল</h2>
                    <div className="relative w-48 h-48 mx-auto mb-6">
                      <svg className="w-full h-full" viewBox="0 0 36 36">
                        <path
                          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                          className="stroke-current text-gray-200" fill="none" strokeWidth="3.8" />
                        <motion.path
                          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                          fill="none" strokeWidth="3.8" strokeDasharray={`${result}, 100`}
                          className="stroke-current text-[#FF6B81]"
                          initial={{ strokeDasharray: '0, 100' }}
                          animate={{ strokeDasharray: `${result}, 100` }}
                          transition={{ duration: 1.5, ease: 'easeInOut' }}
                        />
                      </svg>
                      <div className="absolute inset-0 flex items-center justify-center">
                        <motion.span
                          className="text-5xl font-bold text-[#FF6B81]"
                          initial={{ opacity: 0 }}
                          animate={{ opacity: 1 }}
                          transition={{ delay: 0.5, duration: 0.5 }}
                        >
                          {result}%
                        </motion.span>
                      </div>
                    </div>

                    <p className="text-xl text-gray-700 mb-8">{resultTexts[selectedCategory as MeterCategory](result)}</p>

                    <div className="flex justify-center space-x-4">
                      <button className="flex items-center px-6 py-2 bg-[#6C63FF] text-white font-semibold rounded-full shadow-md hover:bg-opacity-90 transition-all">
                        <FaShareNodes className="mr-2"/> শেয়ার করুন
                      </button>
                      <button onClick={resetForm} className="flex items-center px-6 py-2 bg-gray-200 text-gray-700 font-semibold rounded-full hover:bg-gray-300 transition-all">
                        <FaArrowRotateRight className="mr-2"/> আবার করুন
                      </button>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>
          </div>
        );
      };

      const PollPage: React.FC = () => {
        const [polls, setPolls] = useLocalStorage<Poll[]>('polls', []);
        const [votedPolls, setVotedPolls] = useLocalStorage<string[]>('votedPolls', []);
        const [showConfetti, setShowConfetti] = useState(false);

        const handleVote = (pollId: string, optionIndex: number) => {
          if (votedPolls.includes(pollId)) return;

          const newPolls = polls.map(poll => {
            if (poll.id === pollId) {
              const newOptions = [...poll.options];
              newOptions[optionIndex].votes += 1;
              return { ...poll, options: newOptions };
            }
            return poll;
          });

          setPolls(newPolls);
          setVotedPolls([...votedPolls, pollId]);
          
          setShowConfetti(true);
          setTimeout(() => setShowConfetti(false), 5000);
        };
        
        const PollCard: React.FC<{ poll: Poll, onVote: (pollId: string, optionIndex: number) => void, votedPolls: string[] }> = ({ poll, onVote, votedPolls }) => {
          const [selectedOption, setSelectedOption] = useState<number | null>(null);
          const [showResult, setShowResult] = useState(votedPolls.includes(poll.id));
          const COLORS = ['#FF6B81', '#6C63FF', '#FFD93D', '#4BC0C0', '#9966FF'];

          const totalVotes = poll.options.reduce((sum, opt) => sum + opt.votes, 0);

          const handleVoteClick = () => {
            if (selectedOption !== null) {
              onVote(poll.id, selectedOption);
              setShowResult(true);
            }
          };

          const chartData = poll.options.map(opt => ({ name: opt.text, votes: opt.votes }));

          return (
            <motion.div 
                layout
                initial={{ opacity: 0, y: 50 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0 }}
                className="bg-white p-8 rounded-2xl shadow-lg mb-8"
            >
              <h2 className="text-2xl font-bold mb-2">{poll.title}</h2>
              <p className="text-gray-500 mb-6">{poll.description || `ক্যাটেগরি: ${poll.category}`}</p>

              <AnimatePresence mode="wait">
                {!showResult ? (
                  <motion.div key="vote" exit={{ opacity: 0, y: -20 }}>
                    <div className="space-y-4 mb-6">
                      {poll.options.map((option, index) => (
                        <label
                          key={index}
                          className={`block p-4 border-2 rounded-lg cursor-pointer transition-all ${
                            selectedOption === index ? 'border-[#6C63FF] bg-purple-50 shadow-inner' : 'border-gray-200 hover:border-purple-300'
                          }`}
                        >
                          <input
                            type="radio"
                            name={`poll-${poll.id}`}
                            className="hidden"
                            onChange={() => setSelectedOption(index)}
                          />
                          <span className="text-lg">{option.text}</span>
                        </label>
                      ))}
                    </div>
                    <motion.button
                      onClick={handleVoteClick}
                      disabled={selectedOption === null}
                      whileHover={{ scale: selectedOption !== null ? 1.05 : 1 }}
                      className="w-full p-3 bg-gradient-to-r from-[#FF6B81] to-[#FFB6C1] text-white font-bold rounded-full shadow-md disabled:bg-gray-400 disabled:cursor-not-allowed"
                    >
                      ভোট দিন
                    </motion.button>
                  </motion.div>
                ) : (
                  <motion.div key="result" initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>
                    <h3 className="text-xl font-semibold mb-4">ফলাফল</h3>
                    <div className="h-64 w-full">
                      <ResponsiveContainer width="100%" height="100%">
                        <BarChart data={chartData} layout="vertical" margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>
                          <XAxis type="number" hide />
                          <YAxis dataKey="name" type="category" width={80} tick={{ fill: '#4A5568' }}/>
                          <Tooltip cursor={{fill: 'rgba(238, 238, 238, 0.5)'}}/>
                          <Bar dataKey="votes" barSize={30} radius={[0, 10, 10, 0]}>
                            {chartData.map((entry, index) => (
                                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                            ))}
                          </Bar>
                        </BarChart>
                      </ResponsiveContainer>
                    </div>
                    <p className="text-center mt-4 text-gray-600 font-semibold">মোট ভোট: {totalVotes}</p>
                  </motion.div>
                )}
              </AnimatePresence>
            </motion.div>
          );
        };
        

        return (
          <div className="container mx-auto px-6 py-12">
            {showConfetti && <Confetti recycle={false} numberOfPieces={300}/>}
            <h1 className="text-4xl font-bold text-center mb-12">সক্রিয় ভোট</h1>
            <div className="max-w-3xl mx-auto">
              {polls.length > 0 ? (
                polls.map(poll => (
                  <PollCard key={poll.id} poll={poll} onVote={handleVote} votedPolls={votedPolls} />
                ))
              ) : (
                <div className="text-center py-16 bg-white rounded-2xl shadow-md">
                  <p className="text-2xl text-gray-500">এখন কোনো সক্রিয় ভোট নেই।</p>
                </div>
              )}
            </div>
          </div>
        );
      };
      
      const AdminPage: React.FC = () => {
        const [isLoggedIn, setIsLoggedIn] = useState(() => sessionStorage.getItem('isAdminLoggedIn') === 'true');
        const [password, setPassword] = useState('');
        const [error, setError] = useState('');

        const [polls, setPolls] = useLocalStorage<Poll[]>('polls', []);
        const [editingPollId, setEditingPollId] = useState<string | null>(null);
        const [newPoll, setNewPoll] = useState({
          title: '',
          description: '',
          options: ['', ''],
          category: 'মজা',
          duration: 7,
        });
        
        const ADMIN_PASSWORD = "admin";

        useEffect(() => {
          sessionStorage.setItem('isAdminLoggedIn', String(isLoggedIn));
        }, [isLoggedIn]);

        const handleLogin = () => {
          if (password === ADMIN_PASSWORD) {
            setIsLoggedIn(true);
            setError('');
          } else {
            setError('ভুল পাসওয়ার্ড!');
          }
        };
        
        const handleLogout = () => {
          setIsLoggedIn(false);
          sessionStorage.removeItem('isAdminLoggedIn');
        }

        const handleOptionChange = (index: number, value: string) => {
          const options = [...newPoll.options];
          options[index] = value;
          setNewPoll({ ...newPoll, options });
        };

        const addOption = () => {
          if (newPoll.options.length < 5) {
            setNewPoll({ ...newPoll, options: [...newPoll.options, ''] });
          }
        };
        
        const removeOption = (index: number) => {
          if (newPoll.options.length > 2) {
            const options = newPoll.options.filter((_, i) => i !== index);
            setNewPoll({ ...newPoll, options });
          }
        };
        
        const resetForm = () => {
          setEditingPollId(null);
          setNewPoll({ title: '', description: '', options: ['', ''], category: 'মজা', duration: 7 });
        }

        const handleEdit = (poll: Poll) => {
          setEditingPollId(poll.id);
          setNewPoll({
            title: poll.title,
            description: poll.description || '',
            options: poll.options.map(o => o.text),
            category: poll.category,
            duration: poll.duration
          });
        }

        const handleSubmit = () => {
          if (!newPoll.title || !newPoll.options.every(opt => opt.trim() !== '')) {
              alert('Please fill out the title and all options.');
              return;
          }

          if (editingPollId) {
              setPolls(polls.map(p => p.id === editingPollId ? {
                  ...p,
                  title: newPoll.title,
                  description: newPoll.description,
                  options: newPoll.options.map((optText, index) => {
                      const oldOption = p.options[index];
                      return oldOption && oldOption.text === optText ? oldOption : { text: optText, votes: 0 };
                  }),
                  category: newPoll.category,
                  duration: newPoll.duration,
              } : p));
          } else {
              const pollToAdd: Poll = {
                  id: new Date().toISOString(),
                  title: newPoll.title,
                  description: newPoll.description,
                  options: newPoll.options.map(opt => ({ text: opt, votes: 0 })),
                  category: newPoll.category,
                  createdAt: Date.now(),
                  duration: newPoll.duration,
              };
              setPolls([pollToAdd, ...polls]);
          }
          resetForm();
        };

        const deletePoll = (id: string) => {
          if (window.confirm("আপনি কি এই পোলটি মুছে ফেলতে চান?")) {
              setPolls(polls.filter(poll => poll.id !== id));
          }
        }

        if (!isLoggedIn) {
          return (
            <div className="container mx-auto px-6 py-20 flex justify-center items-center" style={{minHeight: 'calc(100vh - 200px)'}}>
              <div className="w-full max-w-sm bg-white p-8 rounded-2xl shadow-xl">
                <h1 className="text-2xl font-bold text-center mb-6">অ্যাডমিন লগইন</h1>
                <input
                  type="password"
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  onKeyDown={(e) => e.key === 'Enter' && handleLogin()}
                  placeholder="পাসওয়ার্ড দিন"
                  className="w-full p-3 border border-gray-300 rounded-lg mb-4"
                />
                {error && <p className="text-red-500 text-center mb-4">{error}</p>}
                <button onClick={handleLogin} className="w-full p-3 bg-[#6C63FF] text-white font-bold rounded-full">
                  প্রবেশ করুন
                </button>
              </div>
            </div>
          );
        }

        return (
          <div className="container mx-auto px-6 py-12">
            <div className="flex justify-between items-center mb-12 flex-wrap gap-4">
                  <h1 className="text-4xl font-bold">অ্যাডমিন ড্যাশবোর্ড</h1>
                  <button onClick={handleLogout} className="flex items-center px-4 py-2 bg-gray-600 text-white font-semibold rounded-full hover:bg-gray-700 transition-all text-sm sm:text-base">
                      <FaArrowRightFromBracket className="mr-2"/> লগআউট
                  </button>
              </div>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
              <div className="bg-white p-8 rounded-2xl shadow-lg">
                <h2 className="text-2xl font-bold mb-6">{editingPollId ? 'পোল সম্পাদনা করুন' : 'নতুন পোল তৈরি করুন'}</h2>
                <div className="space-y-4">
                  <input type="text" placeholder="পোলের শিরোনাম (বাংলায়)" value={newPoll.title} onChange={e => setNewPoll({...newPoll, title: e.target.value})} className="w-full p-3 border rounded-lg"/>
                  <textarea placeholder="সংক্ষিপ্ত বিবরণ (ঐচ্ছিক)" value={newPoll.description} onChange={e => setNewPoll({...newPoll, description: e.target.value})} className="w-full p-3 border rounded-lg h-24"/>
                  <div>
                    <label className="font-semibold">অপশনগুলো</label>
                    {newPoll.options.map((opt, index) => (
                      <div key={index} className="flex items-center space-x-2 mt-2">
                        <input type="text" placeholder={`অপশন ${index + 1}`} value={opt} onChange={e => handleOptionChange(index, e.target.value)} className="w-full p-2 border rounded-lg"/>
                        {newPoll.options.length > 2 && <button onClick={() => removeOption(index)} className="p-2 text-red-500 hover:bg-red-100 rounded-full"><FaTrash /></button>}
                      </div>
                    ))}
                    {newPoll.options.length < 5 && <button onClick={addOption} className="mt-2 flex items-center text-sm text-[#6C63FF] font-semibold"><FaPlus className="mr-1"/> অপশন যোগ করুন</button>}
                  </div>
                  <select value={newPoll.category} onChange={e => setNewPoll({...newPoll, category: e.target.value})} className="w-full p-3 border rounded-lg bg-white">
                    <option>রাজনীতি</option>
                    <option>সমাজ</option>
                    <option>ট্রেন্ড</option>
                    <option>মজা</option>
                  </select>
                  <input type="number" placeholder="সময়কাল (দিন)" value={newPoll.duration} onChange={e => setNewPoll({...newPoll, duration: parseInt(e.target.value) || 0})} className="w-full p-3 border rounded-lg"/>
                  <div className="flex space-x-2">
                      <button onClick={handleSubmit} className="w-full p-3 bg-gradient-to-r from-[#FF6B81] to-[#FFB6C1] text-white font-bold rounded-full">{editingPollId ? 'আপডেট করুন' : 'পোল তৈরি করুন'}</button>
                      {editingPollId && (
                        <button onClick={resetForm} className="w-1/2 p-3 bg-gray-200 text-gray-700 font-semibold rounded-full hover:bg-gray-300 transition-all">বাতিল করুন</button>
                      )}
                  </div>
                </div>
              </div>

              <div className="bg-white p-8 rounded-2xl shadow-lg">
                <h2 className="text-2xl font-bold mb-6">বিদ্যমান পোলসমূহ</h2>
                <div className="space-y-4 max-h-[32rem] overflow-y-auto pr-2">
                  {polls.length > 0 ? polls.map(poll => (
                      <div key={poll.id} className="p-4 border rounded-lg flex justify-between items-center bg-gray-50/50">
                          <div>
                              <h3 className="font-semibold">{poll.title}</h3>
                              <p className="text-sm text-gray-500">{poll.category} - মোট ভোট: {poll.options.reduce((a, b) => a + b.votes, 0)}</p>
                          </div>
                          <div className="flex items-center space-x-1">
                              <button onClick={() => handleEdit(poll)} className="p-2 text-blue-500 hover:bg-blue-100 rounded-full transition-colors"><FaPencil /></button>
                              <button onClick={() => deletePoll(poll.id)} className="p-2 text-red-500 hover:bg-red-100 rounded-full transition-colors"><FaTrash /></button>
                          </div>
                      </div>
                  )) : <p className="text-center text-gray-500 py-8">কোনো পোল তৈরি করা হয়নি।</p>}
                </div>
              </div>
            </div>
          </div>
        );
      };

      // ============= MAIN APP =============

      const App: React.FC = () => {
        return (
          <HashRouter>
            <div className="flex flex-col min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 overflow-x-hidden">
              <Header />
              <main className="flex-grow">
                <Routes>
                  <Route path="/" element={<HomePage />} />
                  <Route path="/calculate" element={<CalculatePage />} />
                  <Route path="/poll" element={<PollPage />} />
                  <Route path="/admin" element={<AdminPage />} />
                </Routes>
              </main>
              <Footer />
            </div>
          </HashRouter>
        );
      };

      // ============= RENDER APP =============
      
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }

      const root = ReactDOM.createRoot(rootElement);
      root.render(
        <StrictMode>
          <App />
        </StrictMode>
      );
    </script>
</body>
</html>
